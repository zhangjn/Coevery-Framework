@model RoleEditViewModel
@using Coevery.Roles.ViewModels;

@{ Layout.Title = T("Edit Role").ToString(); }
<div class="row-fluid edit-mode">
    @using (Html.BeginFormAntiForgeryPost())
    {
        @Html.ValidationSummary();
        <fieldset>
            <legend>@T("General Information")</legend>
            <div class="data-row clearfix">
                <div class="span12 control-group">
                    @Html.LabelFor(m => m.Name, T("Role Name").Text, new { @class = "title control-label required" })
                    <div class="control controls errortips">
                        @if (Model.Name == "Administrator")
                        { // the one special case
                            <input class="span12" id="Name" type="text" value="@Model.Name" readonly="readonly" />
                            <input name="Name" type="hidden" value="@Model.Name" />
                        }
                        else
                        {
                            <input class="span12" type="text" id="@Html.IdFor(m => m.Name)" name="@Html.NameFor(m => m.Name)" required="" data-msg-required="This field is required." maxlength="100" value="@Model.Name" placeholder="" />
                        }
                    </div>
                </div>
            </div>          
            <input type="hidden" value="@Model.Id" name="Id" />
        </fieldset>
        <fieldset>
            <legend>@T("Permissions")</legend>
            <div class="data-row clearfix">
                @foreach (var category in Model.RoleCategoryPermissions.Keys)
                {
                    <div class="span12 control-group">
                        <h5 class="control-label">@category</h5>
                        <label class="control-label"></label>
                        <div class="controls">
                            <table class="table table-condensed">
                                <colgroup>
                                    <col id="Col1" />
                                    <col id="Col2" />
                                </colgroup>
                                <thead>
                                    <tr>
                                        <th scope="col">@T("Allow")</th>
                                        <th scope="col">@T("Effective")</th>
                                        <th scope="col">@T("Permission")</th>
                                    </tr>
                                </thead>
                                @foreach (var permission in Model.RoleCategoryPermissions[category])
                                {
                                    <tr>
                                        <td style="width:60px;">
                                            @if (Model.CurrentPermissions.Contains(permission.Name))
                                            {
                                                <input type="checkbox" value="true" name="Checkbox.@permission.Name" checked="checked" />
                                            }
                                            else
                                            {
                                                <input type="checkbox" value="true" name="Checkbox.@permission.Name" />
                                            }
                                        </td>
                                        <td style="width:60px;">
                                            @if (Model.EffectivePermissions.Contains(permission.Name))
                                            {
                                                <input type="checkbox" disabled="disabled" name="Effective.@permission.Name" checked="checked" />
                                            }
                                            else
                                            {
                                                <input type="checkbox" disabled="disabled" name="Effective.@permission.Name" />
                                            }
                                        </td>
                                        <td>@T(permission.Description)</td>
                                    </tr>
                                }
                            </table>
                        </div>
                    </div>
                }
            </div>
        </fieldset>
        @Display.EditViewAction()
    }
</div>